"""
Some tests of Elections Algs
"""

# give the base path for importing
import sys
sys.path.append('../')

from helios import utils
from crypto import algs, electionalgs

# parse an election
election = electionalgs.Election.fromJSONDict(utils.from_json("""
{"election_id": "agxoZWxpb3N2b3RpbmdyDgsSCEVsZWN0aW9uGDUM", "name": "Testing", "pk": {"g":
"68111451286792593845145063691659993410221812806874234365854504719057401858372594942893291581957322023471947260828209362467690671421429979048643907159864269436501403220400197614308904460547529574693875218662505553938682573554719632491024304637643868603338114042760529545510633271426088675581644231528918421974",
"p":
"169989719781940995935039590956086833929670733351333885026079217526937746166790934510618940073906514429409914370072173967782198129423558224854191320917329420870526887804017711055077916007496804049206725568956610515399196848621653907978580213217522397058071043503404700268425750722626265208099856407306527012763",
"q":
"84994859890970497967519795478043416964835366675666942513039608763468873083395467255309470036953257214704957185036086983891099064711779112427095660458664710435263443902008855527538958003748402024603362784478305257699598424310826953989290106608761198529035521751702350134212875361313132604049928203653263506381",
"y":
"138965420538060877725598288443038715549505041934920830506963758871983703536539489932164465777433596361969779587970636705737864807597351351075991866746398793736744305399650068324779832920449571128406381195057599494539495719265448905682934458434094839365843432367426280317832018301235396448313025835566537081578"},
"questions": [{"answers": ["ice-cream", "cake"], "max": 1, "question": "ice-cream or cake?", "short_name": "dessert"}], "voters_hash": "2nMJu6KQ5nNJxySS6vwvCtx\/mbI", "voting_ends_at":
null, "voting_starts_at": null}
"""))
print election.hash

# ballot #1 - 6nGjE9hDIJh+gJLbBs+V8gCnqwM, ice-cream
ballot_1 = electionalgs.EncryptedVote.fromJSONDict(utils.from_json("""
{"answers": [{"choices": [{"alpha":
"79423156875790789386636380711411557382011404179785862301851615012301997738581616233606306565176776628181638207312074846014426085937540815198122397466359879439087155788105406682550892189407933604393108898921993667488924252715342976726016778309376458081564159805006567274567646092947902027698679865295747216740",
"beta":
"143572946708780195227746097638279374240715557430362133497355213227909252587541440720698294397928771371398316440609397662289105847496010523722521262815906074191163698789679619483819131879040287456403168217586341933589428747564875966367655575868585312270511247141253264850857205009342714491750000543927983547067"},
{"alpha":
"24649237060119825898230579770062433501527408953598772450873437762686027284229586224876293478401349759892180283537796569765680781002239651357595392751435996613998837243105555985368958866562000845697200263898545146523028797479534681009418642713785547377151966355257490739865674397955223055114479655315692948265",
"beta":
"126318762404082107842714441516703626517411481656633117177427850907458042492052355273278564825248670230074125592481992297606345082305536111322412641605729716257793713019548681058974156798145856918565893320771889464252884332992855261670439911330092025552471603056402468364445712128928259127356482860821080240877"}],
"individual_proofs": [[{"challenge":
"58281479152760341356873330629884747543523865792267847838721336603847670336937565606243989740223256877805613244063444090806095843017255364915751043169575208861989243713102946329910491925308363858656340506155044457806147526567656741426032937323609503619924177550257756731594535088615197810651272165117080852921",
"commitment": {"A":
"5187714398512094097135437620002436920476767325327318347664040912000083437458154459705386801204629547823761954762891597369707291591694109806024593269944543802338253593440546490930663739975016844178402895247722805200916215493386469149540394498079494389883751339316777219044238575469543665101563798941898244989033298092469690952977981549750680959576815214222895941997557408639461306401613455307503050390392324099980224585924513284147734295274975205209797042628330204376010657341214711338909112790374552754915644778515108349302631714864881349720791298807011155522918082150951762260871375526249077022184440423331755766256",
"B":
"10768350790498778294207195734421555888986205590254862392187834626076652615606244196394640009685592144261053273460684206524461648706054286371315042659550208171271427623894247370014762679032489740125048857008861895971795784692776639208089507501550749171922700290888932578945244518752026946849115790543374923047688432978498757837572010619702642203438924875349701191441538892913652893271280798331822496774223649120702735952259781445432174950665557848960618492985352001234302245605881954824837587810473858242565809683222508271682461622411546812212143842866658523943731798037606550623715945146874267088969001575921393317120"},
"response":
"48890141872537871828659476605780740990132542069377631985784551654101326187407625461924823516272326915381447918697207391965808872338561539445656837941990482467355927880410333821696170472927298967092227608733172647082825760737233258097881351421285015111618199673287723918498325873255438905153282094581081016947"},
{"challenge":
"26713380738210156610646464848158669421311500883399094674318272159621202746457901649065480296730000336899343940972642893085003221694523747511344617289089501573274200188905909197628466078440038165947022278323260799893450897743170212563257169285151694909111344202116898464899826969834862838011412847487455316259",
"commitment": {"A":
"125658150250856478678195601626307742932112703112762438881868756818615303927392133217193599394513963739158702558362127183360137875942253497650130409371499888174280319469661543155435312027202858214790295474524115863051446094110071055790001048784037389409682558839207117981013725405110193829037047949751675467573",
"B":
"15918415159104747178787814905711034321473386451808398454105452050752625396819560601917614144887111338432585388433896130616668465859484554199619732496792328118272421957068789943999724869638778402107566756164044010734302735230956906215030952965282910158429345234970966981021280353753995049862657650980523943248"},
"response":
"105445971788800834108427404271331200364414828879346591679491102267251624199524296183705160915580000531372243077082260773233439875662894720539206298245795009809846569523375036104312563586032755506247668772529713307172918145951013541215054520107643059463335507166570952704571632962086882311553528349716576263359"}],
[{"challenge":
"16266105610313843443406755768679288321289553186559012737082395616796710687876452232248010844072249360659732335991781934225478052599607717108888286467396367381529906852144107081310642949730495715316548804408112652035610580483401804737777232286161863699544516317827752928976234171812739178183019404060309627166",
"commitment": {"A":
"39561795652147476375129679934625046201561576993002041556248408385438393468473511432091030774137406698373154347923025911720993301593611503165868533969463018971848984772136030551905697664753064725312645674286448572505144661457933123086674986246725481594411233755288813422719672487035668732657402305860553243694",
"B":
"94768839623258403035525427819532653082414960726127379073055033293724911761828891605040272987307672343460128899265326785753891982987880396154715466734770569393847394490485399706097894540030049086180216598060011231665747612343848674572553330517088391096399472562500266783567391344680209723929668524503395958534"},
"response":
"118266658361587224567764917905277042724673312990600946851325421596557667204670511558336934789400384205029911763698200350411973630313656428694541028269387645845939087319416460687203175481451870024613576875213213730833072138316812147050611209950518743321931207231759418828744652439964961714414537196195174052939"},
{"challenge":
"68728754280656654524113039709364128643545813489107929775957213146672162395519015023061459192881007854045224849044305049665621012112171395318207373991268343053733537049864748446228315054017906309286813980070192605663987843827425149251512874322599334829491005435102431648059074120648306768261963393082158983650",
"commitment": {"A":
"144371548984361160663935401660105144900943814418834418078933840346145357819608905426729744157220553412675413172436916714381690271628455816962533450972022004344888152102130822876802653891119441307428246909252736430115078267273856724395241631687680270180838369625479747605752380124595141781266138940256141297826608853369510359624710675204155307333135094604582647203854992303930562422132073559345304696284832088626290351040662121255748821427729448072384315544809746854610907135272056473062182985441266742448091141067271545135089983470529725093509464933291966577587947835774767000130368421264714221063657242715538989675",
"B":
"19557147578419829982449767974427352510715453201745107257180022061917371313017827944929837874800019202472114951841673224231999576263278205816887018184756817001083425636301636310650440871511367100788275250265303060039273569378572786066029709602987759930895730844639349799085592101224426007719904251480791968064011182908576885889994134800522231055979239817449935579203167153171881959668790887879889971782991824724143029589730142375728221091774755758327627547137379631621461696050094757617725754386530965849178315188952417224792258353061547204477596036345597894078013183538494400523956767009527948674925312773306953642382"},
"response":
"44778581605060061468202879694309568161867801928565909031077882599797953455233034812218523231424306928094875170857652879303178793795642915085094849990144174842755683854951971398211234094599354760721042670627663147520798111069101877788630553286268094944157066321423004066531920225042970953355910203983823162431"}]],
"overall_proof": [{"challenge":
"52607214019579720470089061302571769283225740243927460055623773180400799412716866330574567764114331697580411042962490044292772387259543930706814438718972064535056831124421051419056490944388052579907190805430116636602698801793515348578983532608977387305915438422759824946080195353964486348698297356309936229046",
"commitment": {"A":
"1683242269199547286589052316937327492684943111618460941600534271749540454530496609727047468186997208852661384978320308583547002626518618088266069750334587978182776654920841881592149881354090941174530898032094829877902331863204184274117221664628926723482917612621504865426717992305157701820458216289070041018803673245355826677287856391407098520049301575301468167824704778215111311401717929151668009976846208739058044793943943509992447929347518831765557631444814641148090857228768467965884106263247455191650577847758107500644241296621755727100544764577711949165032581901929540704905255254862747644228896476872762475779",
"B":
"532886804451382202719008240348658694222206938910344555699292509321957360817996248461129879492174653859718664424939429967649487956957340200152195213754050836294846283217926054191637252491287082751985017951605147848642624699125799576369678347458068379803409509093674596370689389775752710972763096821795233624430584595160014038046397036981894595232293461492617479956470022830561644307923714049697888413325416519992555110187329346343481994923936723482221184176704454340205149218055453456901157878799563776387950290627940784810802828827080557092014350626723222326726647966666259076352566364180726596072810562011670339200"},
"response":
"21540695690737134434174651664949898629333554069096185796442628373499990509289048294782645929781200608838370090085222455052727757187466500562122995003033279339370497001163461123989388245036878903141269107915920819514645302894076519280799747908453427279438821866669484414972214486517973820480552328860779906593"},
{"challenge":
"32387645871390777497430734175471647681609626431739482457415835583068073670678600924734902272838925517124546142073596939598326677452235181720281221739692645900206612777587804108482467059360349444696171979048188621096899622517311605410306573999783811223120083330385889460465126953050310771164183432320529793193",
"commitment": {"A":
"75142418130759277429213229941029782228670512549639236174315936840969468086457928004158898468480260131085557037605646188962233463653847423848678014562309939828876985713691886587934394313352022568313993609444376297973214147523033713507817372991624566585410365382279988792850201867619204988352436411122162090828",
"B":
"17444117482977974901758628611013389276233492917967402322437208246960916336228973332383004675258152669787982773857315189018602341185875906275647442569599662901215726172079375993221084929801374044149612089361070260754468349972659496337279076867324944234848938117134081522903255749228140485559002352715736912707"},
"response":
"105925923576361838810228768402661399171863373349971114427186504095673656227780325033957248858444118272393303865517714686177901209283388505851601109596061697551019523887434192995063509232786767549030055327929594454941270230415210779914694839969385082600039668435219391294478287029818695491610190979092245498255"}]}],
"election_hash": "BfIA7fRcIWcOzvo9NneOWikwZqM", "election_id": "agxoZWxpb3N2b3RpbmdyDgsSCEVsZWN0aW9uGDUM"}
"""), election.pk)



# ballot #2 - Ma90MRM+iLZWxxUiTirbpaqp8eo, cake
ballot_2 = electionalgs.EncryptedVote.fromJSONDict(utils.from_json("""
{"answers": [{"choices": [{"alpha":
"78454100981663368932465092656713871228650967506558712658782406784793844667524153043017923922103073546870759419965815858066146308905943442162975343983537456635838087185992821971940516811024302718972657843807895907317281950662914815422978817105940419155005672363749089725684818849347832835161343273445397826761",
"beta":
"128552134579521645580758906484506848329626687099662222361433950474985871887499556688851959817852213599509127907757332566744777536918942344825130883434099517378071148302743225453498472557761927709826593991564545576993632791038663477002531874707223598917447725474113170838836452816442116091189239572034284954038"},
{"alpha":
"72084323079172695008087877802199779222710090413751221913191294653276366484273048438738932606805910429746671392976973435270896491970981453441747355230058116314170458057911122588022577444370043110962817075250440399776348520209795783645130949690267802060858254821507902453643108185568044238697348565907443976223",
"beta":
"118592787034392650381768713087421801355100586008825785011097982830702183782890253644190887520686828445878008095930955667700950542443823977971760555841097668450911711965866154088268196986183700201266696664859095203973708821438151813808372393461456726673456847355855662907817274427826295878309886797181001854224"}],
"individual_proofs": [[{"challenge":
"72308769033004663617094020672650419790664824323295575737539165634580183120278623740128679765170858554818580228226771940421339783821744199933658037061254709391848475857751807541296286874726050341943392536994343360883105092902206032015831662631356319479725533970972595690696279043183047268989024160742869457238",
"commitment": {"A":
"147805320492330854527606864867002177012906424154124603003709753808263796661710239300057344416155114537096115944299569539242532682904128399435327962388658279842267260763178348862276983423720893927078244223681778012262648520766627490183861697256255470749465013640176060773199519399081397495418600625482973381585",
"B":
"159855910381190840952097368500323275007023690541919593628805176192737510316803697529934222145660319188573413273445092458586647429772297358181186699179806677761325643788629417019494562460928848192570206116382218822696499383507770984341397928337395225239819366364624464402778684575028841782593490207268301045642"},
"response":
"154589571036435475413900174889150096048812673966882479104181225898192326156986325395616457245633927522782905037146191557147728184368889701424125090032633088222890730183324895249851453468601462828980179605842642255776710744712563303470967113631491348630984324198060629276194001851668464311543188044581799947601"},
{"challenge":
"12686090857965834350425774805392997174170542352371366775500443128888689963116843515180790271782398659886376956809315043469759280890034912493437623397410001043414968044257047986242671129022351682659970247483961896816493331408620921973458443977404879049309987781921629230477323016563573212654507142771242560551",
"commitment": {"A":
"18630512237166589212441123991417485535649099304032540307732421308696912544715981352652940493819572937491204305715733887363610860985520841609660203732131699007621255475942027800496786392612050766161108771505883780773802158360102422909096545024168554255419866947686722546201530494567312383499669585188429566057881359234972986426971715729988907703138856575000331885522318012173543115297995299927266435118262595791359573094920766804578905011232623263508441052216826317572740449015807117550191813160239265530650319743768903952481036146324119757613109937530299523949348222176652412851961197694480150747668079709970309606178",
"B":
"12943063573355201555464542378481693970267323092415764499646479979911452295187952638251526046387383969821711410038464981638141930623474669302044262775045319209428214616814658075457962069597378579686003005588273687314538982422728911650458450157800517445017061980678039505551393479268653497368397676083121666591296922816194289940377757177882012468126596176916201505785652819039234403249730104332638646131016392842611440533585836219222174017348096422876722199716034195165646724634372462217233458199412611972559342551817583556640925798701472425632131626876625291026308061954511673232049446396069282946279111999681409502703"},
"response":
"43218096115329136432449813028650087183436299149301786903265013574806073431292461527839070995592224032911941646081751141150040436177405174008355615225826463399035978101236062616512819714734146836562101449482321291034335555523992501865071778867606360383704420850608359942530177511072710596949297231174063328493"}],
[{"challenge":
"31707753390463753680596941452763467845574349192489677265536979919125120101419992748083077105142521974174469798838383382300951806433815450417383348650670720672686548904449788881415972832678266829637465825290052065559787682079330253046600207004511078848339792571713724129896579869384917679381631330651393860529",
"commitment": {"A":
"523385187454159848802813639840616546776448685689872469287249081337667306646941253179370495971924311907744769132191295914489311416049213796101376792475841931144516946906977545024581681254363971390957608750458867172994709593282525425351397505381554678361493352907670371066465096191005247294945769776698582863101279625081090178819484216731610062915131650657185707456743637807739431985149635416499575295307810279001737302390141055633608688903118073274638354184171811246975992088119137504800317772118044167030804389450344492715289828530826168498522343066558343762201205027735617498518178788094357934045071915172020863340",
"B":
"3636941408649046070418378129793595586547331873050001755577868533767373024905375752197439206634208125466557155705732625255901050297477258105193150178466872060086374371749484383345539604584618536910648827513364896309547016926708487940204725452980532320412937509463542184148186187622199890700261823227156517657268376384906521555341078670201353272197967417620562133415973368102996116321450382766791549694797929112875109030296760343757674757206659201987240284326276342342160527727026928783775261633901711887245089219052816010308968764056017664058283337671424252651573892456639405897448213878060598232036838989457855152417"},
"response":
"49849883485910180476629493070831330470335604268504659106051185197775771892775643199798017187519376786205208638405169839349133621408134412843877706541328375597928064354184663920049026834168342799476779383548554334301638505115101068148777327681569125365210971157036655667949415711604938335873919132147912009033"},
{"challenge":
"53287106500506744286922854025279949119261017483177265247502628844343752981975474507226392931810735240530487386197703601590147258277963662009712311807993989762576894997559066646122985171070135194965896959188253192139810742231496700942689899604250119680695729180493821796628766303959843601500390279060639138396",
"commitment": {"A":
"16317367952253576297652427487429210954912620878845147489373289777304767601832591991973566204674426939026811544702711416848004300638130658299979854884172090483442004779311357525690162016742700303073398916006524652166080744122052136590806473021446207661253091360183646609808077346932120489001744338407523237746",
"B":
"62874398817447423135114051739524599859151374047101084180938170032094625816996191341132481498166274851526349085749486050378614878236675394544445979512432163020110952721926943213552181615492397705394942054204853215513060265260991935040602239789087822976575023495518623334896979651841398262827393258210684023185"},
"response":
"96518021624499483502227897505750559739082407231983372659018597570224580638585033534820256686176745812735036692555333757267918240893706361792670861408008262733509193494670292209419267803421727301086517616131304322323188625083921757442740895432519423951835971170658851284106133749064030588111601069292650736537"}]],
"overall_proof": [{"challenge":
"24641015064380798967624388978564828627304934445533139044861949435022805650838602671648906863501916490038756694774078230651492013477353797391956269805369346027047367515641133468537874970462787439502925341304390491432492241437523602227981063030689488774445299264175190774102065327612818878265899585325045205046",
"commitment": {"A":
"3886305591190121753817015449025072967434336324712434429232246877623781770860044595423161269467356170909044685432998599934561934342798832311374162361330944830448056792343770483217764204474223704446277459398885919786708068159524317112142698429339521803853206279112411824554408426304643446158216026874026512204818647410729077713102688441760345229674700445845005418468080580280620408472286850006559933506649899341786185375774810232557755981488409812672416574796899285991867678764269648367507183569044080503433788628377358093386905144214392004579571972541651231630260509953103375474530979815565353831356764773123017400840",
"B":
"4215251749317642907813694796200084918679821825283421241589900878055543219338497099149461433721171911174828730197043707704062207202991029684876281325409063485912900848882990491669377939644441799432890839746358266533507918362707961182826434560345760547216984120698104514417267249235764709740852266774119960593867890784898647048747160291189158456790334294945810121685355766368966767454179391400015615786171503271272610064761514442301966903952624996987326939942722018933083069516279050393260438358073879627452137006708995020038734563687939918536444038172803332875619114896665733684878652984091495231256053041040428625292"},
"response":
"23468114919097595372872562226104865134931169537620555209340977337397347198382731736801513099300742316374975929418064557885739605478451857355319717209017230520591555416334293977632250455796986283379316149818866598087986787038911408876618693371375833556312582140375989523565035374497817763681367008708344110280"},
{"challenge":
"60353844826589698999895406499478588337530432230133803468177659328446067432556864583660563173451340724666200490262008753239607051234425315035139390653295364408216076386367722059001083033285614585100437443173914766267106182873303351761309043578071709754590222488778787678020255636840600259764315389621088710698",
"commitment": {"A":
"95387376058535350352740402640539294942872893198019218794529892920401248998579394294534727759597880789339779216980555924413382878352304685249675273388455617883521713808445688860430465449041672357805984834288222552384471009637257405364493772423254129689324622168793750526921880865426899269670806338836039611755",
"B":
"81682838833856454157668430763816601821717513804467283237932228134117267924186274326451670214942306048794480447168185283739522355720447650344336867067909828773128572338165461696344999239061021168814412776291427689790277093838256246105954033989071037356530983781525035194310232055308097803373604373376147520383"},
"response":
"124430275493281233634102263800165040997434805351498538918480403211452659348089943568528380554792915352823867486422759184876892251007676639650829881708798742617766180446197478085819487536003732830221544950218298776068633836242414994937529555981726663625480882437441028636644350959471115774511674140410714311625"}]}],
"election_hash": "BfIA7fRcIWcOzvo9NneOWikwZqM", "election_id": "agxoZWxpb3N2b3RpbmdyDgsSCEVsZWN0aW9uGDUM"}
"""), election.pk)

# ballot #3 - RRI4Vs+l40uTpLoCSrydmmQ8B34, cake
ballot_3 = electionalgs.EncryptedVote.fromJSONDict(utils.from_json("""
{"answers": [{"choices": [{"alpha":
"81642020430918166775570713406678183593369218820302857306382356094089432167331031079478937392783784933853806670480533268149150236392032485249401254538644938600711126772133477730707354118162610947778313074625833147828602732618924961354100147804929046782888380639576059324126310799930140580197582333069780133121",
"beta":
"107659455986027972241365105865271742817136761737405026830033631753847318698375526455530380512411813699185752379425712229856998904914143796517438721211374978038131171583323303636601142079787371816374530057414828896358901481786377714741595020274990792232091848751203026040116064750804492084759433809448622138588"},
{"alpha":
"139811300128116006671661364907136345793474367919088553577713355889133139837032279945175903052818911789011046892913449639988432948717435185302189263539386524362710849309277230825007098537679074492962293184162130871347948550160214232632353250318752341735956015668182548678346391445208158307454142734100252836339",
"beta":
"132371058019654838083261015479413880207913375096393977014339454470284617819806047340305641510136273772569657725027082757591356786290260998733033915490191850222798029732114514533157366783121728798551133754452110769462559665366747607167788846943241137242508433984838194692200593185048982016091548276328327827592"}],
"individual_proofs": [[{"challenge":
"15307530437981135696462187304331633941967774601151453201112780816635888281677630785818183963746037859295798684136068723659658142111054888840241763752837726748349986127059310695783940828688329409776023447709742350159379106133391362202625176627456867860188818697539922911711162291247553232826716307796931011919",
"commitment": {"A":
"157843883203020296043647396542064480252193728513079890064447326372842589700410897250291480668112733060345293971783517614260199182550459778095175768325555149357501919476563680459675463845679563941098897961759201738051474267354224374507803756055119363995848431688148760458812906030493851577567760432547623504004",
"B":
"55063590672275915664241963639813629270113402866731963421118846188747972767267437070751379538968150660052414385950987782825570205783818669228161859072717181542882478805202640426575632125852297304214861708227370067152791547749901919797102184735716325083129326168792108938641411575918626979983852514901835676268"},
"response":
"60208307795218054742397005472908820057786508403859131841947302184554249872792717376992298654167815895477409206717038921380539019053620013283072188259784593196192607929194725125377875251860354922643399779050816374615826727797648000606680009120746759298952763231914724515642239050920517953010962710165249455454"},
{"challenge":
"69687329452989362271057608173711783022867592074515489311926827946832984801717836469491286073207219355409158500900018260231440922600724223586853896705826983686913457774949544831755017175060072614827339336768562907540219318177435591786664929981304330668846703055347206028323424620524020675455114339069654304999",
"commitment": {"A":
"13284813401609333965748948357807232565547903329487387774244660901398476171004936843654396321192389979867538586764383656037346730282027603469593733052191080635315742601331482441674177243530172505772332690076973348606266549396794812175118277280184729697859538880553945253235407911452600506626768901178592519524660182085199489747090358742125579691873450786119224699776651099724154418058000996870322115514373120024916150423516849303324779833925364644086481102138910420360722318083675440677406707266600878075147126913275745544215160243754005629499723604155419090116003030280454131495937455644607304793272398463315472673168",
"B":
"47653290673253856366692055947880837914309313117550687109444728902589612959442905132375436481929754406201907763310560439305122502589177805927336645254137010394726670957999638482806317605328073528929678671787175099885240796293212660580560680706013422036589452092599986344408723642577027093661004697540901784530616823612482979488310926984282060075294730941434645056214698401849331575621250456492884774896759005363010316441892067174568142784959743828877808060560932159928408315158785289941635760413257113512073614112828371071903805557242607773039326045594851309095236661946514839120831268942908427977414284257777864140"},
"response":
"59362846057298902960053113700259963405822953028819260763464522890725721689821926334286628380250684437316966874529805845677959478148376058875988702519749705109409830944764631251102984606318477985572550727516949704222795665045094678255873923100532722063360168088947984108571250859205235788781012207336841204887"}],
[{"challenge":
"20844789317307387254995576924334844688146593454429921731657687092260229499014748607452016253557326109997440251944398341683143509535168557543913219661805109302175005510460429202554662393414408554229236047380863834171592236076434187023622450536508856172689213879270251352797242668482014398456814282469702612803",
"commitment": {"A":
"12314509731837946885533780363194578177025859354843440998390989746847356864900732839052814676235091358495353744959497940342516506031684461686428798704619732311754086021008671593707666718434658379807589926823976049042536080144882211243838116223398853641531363999693426068945029717011215191686292595100326358884892182552163436998546887339586902308460873002616112614263090678160569195223905244984426368648879318036873354361495748086329024632330292504276598835638571330313913289167265028248662982787134999535353484549773892845676729163292596812486211849774929939434700490697370871832614931037291767165900305890081468581764",
"B":
"11020968433097040350292294077871585332087678021425160040778501805952379587466270198544383542964987396983785768066257764149368333210688792799229050992085735128626178118390931921179497289745590771576953924554856245331384827143001781823273417856960865596400391543419526394623574314263683029305224918182410001449471175759457431984573522447112322831978475464324561649235664129203011281838485736032684959557686157105189978408513702906678964233637650941662406379142351800592809770874634047574186593149425997821439514341756822240449057616509384841431652160977464378891285184939596072059896364579046929692541197138577111158101"},
"response":
"12600854105905573527997946140267937927417594533394069937151557896792678004195124016986428101470541827960953526222758074533164044138354401852063307811751789692274709506644713574401712389287249101539106536098374331021709629766571786509099393959035721454936877778250369162906443607814176565945862765131486195587"},
{"challenge":
"64150070573663110712524218553708572276688773221237020781381921671208643584380718647857453783395931104707516933091688642207955555176610554883182440796859601133088438391548426324984295610333993470374126737097441423528006188234392766965667656072252342356346307873292184159692787170877805737734791497312989376487",
"commitment": {"A":
"105986640400966676219987404316135872080304506565406149080851642395552502409807736821551416798049835268689197940627864620925528361456317175160351752975816509330885200361898944619502936341932570327768493614436434993919030263286426883627036602029032536589379294930808942253717705810398924092479662330912286340746",
"B":
"111219824899944205873984843920102197367443661177570881542014980401751174645796791664281616372525565544952142106066313325832192218375793618511619391389381377291637417088563754503284073568622731675681588722275515703251319820807380101324828386947341880962599521401240543108367474745381711120157861241248466314172"},
"response":
"30248185972400142892648689407972944430581835381946863135407580871702861485960704905290437094668983925280327211378262292118743606617699887847894845386920658045282933970958740865910173530226436986643092262941404299376784065466646758694610671211454303264881412097026057795827791005439228761841858970096593189717"}]],
"overall_proof": [{"challenge":
"35108390383218645183687658331470485321177756558628887739013991676967195352399067132021807602973631115077849686398403602668420717012653861084105269262783983962523919095787118945812065362291654249724327920991337411269983317267302616249228058650948476931998756288429628824940364318767804332817951954058707234078",
"commitment": {"A":
"16085637660705898093852569419104808535961042703147766617777668764293148582677412232570122666230809762579122735665541238449146623433255709671413324340849404339164838993587326917289148239754184605415760479698006886991241442111772488061220998871172794980526245870161672319995172769072147589531974681987883906514791166061877385645044977724918173430119890831724946376077444457378645766070134673302078942246376767543281666400915073873200639438990385797816972195130782351938449070165334083409617299184218586883417485041503054327455432122045466900495078577748118962164010486959739487818232688688764149829524758828155802361300",
"B":
"132927652207931602660623213993218932146428207687517250750095383344371490295572611828697084709315085166778351162266636390502888962541659514408311047898274204478952339316158503951770227342540297315664467732806445452310016340262578625373470406365410638803795397765605356907428872866077355519158624383377379139571196446125344776829557104269800664043157205047213494880811054808095499458753792364868564694152783874597934807455420169090802857746912749026558474406841890295779703871907206934207714339524426917461102173940206884119753431365197385706866127592769260762118264176490295261273018208410078361490333201483257541580"},
"response":
"40087191618042538185719539641522990062913857863779947924124846837283729461842346638209248465647539610527030258942923838209182167534488290762575217345480945009854281222652374956217295417613469519247634106439591564939139006095643117032140414843306779899395128895955691384631933231396172181190619178880568172744"},
{"challenge":
"49886469507751852783832137146572931643657610117038054774025617086501677730996400123287662433979626099627107498637683381222678347699125251342990391195880726472739524806221736581726892641456747774879034863486967846429615107043524337740062047957812721597036765464556102099163812509045162818855682332433466590333",
"commitment": {"A":
"86256719307899875488618257894909040303084834431271622922729789032925673960798434279536253823062059265416025758421916204939498688404581302683338254665164127136528326852180356592948551794118642360591276028691576869433028798881069825860647317884554762599219809373486963698594746467209179618428747340580672707634",
"B":
"119359770796390296234200084367222780180708691526621136487882426248979157334931070397169934308989700633287174659211310371919720620026927331625651713593326869834751613065678457400802145181687493611713975296136129853065145904543319498968102328070726231289093766270154352388028914128085903108053011734129434868917"},
"response":
"90430150848312732386394206004115289946935320918569956695314466877215387538059236277951927823934632776126030858401264463495103446976639340170816210054370670340386936036722489922553194655381232769996132720425031793039972766339692949417335463494604420316110799307044143821462696798642096339671677319031010478648"}]}],
"election_hash": "BfIA7fRcIWcOzvo9NneOWikwZqM", "election_id": "agxoZWxpb3N2b3RpbmdyDgsSCEVsZWN0aW9uGDUM"}
"""), election.pk)


# start tallying
tally = election.init_tally()
print tally

tally.add_vote(ballot_1)
tally.add_vote(ballot_2)
tally.add_vote(ballot_3)

print tally

sk = algs.EGSecretKey.fromJSONDict(utils.from_json("""
{"pk": {"g":
"68111451286792593845145063691659993410221812806874234365854504719057401858372594942893291581957322023471947260828209362467690671421429979048643907159864269436501403220400197614308904460547529574693875218662505553938682573554719632491024304637643868603338114042760529545510633271426088675581644231528918421974",
"p":
"169989719781940995935039590956086833929670733351333885026079217526937746166790934510618940073906514429409914370072173967782198129423558224854191320917329420870526887804017711055077916007496804049206725568956610515399196848621653907978580213217522397058071043503404700268425750722626265208099856407306527012763",
"q":
"84994859890970497967519795478043416964835366675666942513039608763468873083395467255309470036953257214704957185036086983891099064711779112427095660458664710435263443902008855527538958003748402024603362784478305257699598424310826953989290106608761198529035521751702350134212875361313132604049928203653263506381",
"y":
"138965420538060877725598288443038715549505041934920830506963758871983703536539489932164465777433596361969779587970636705737864807597351351075991866746398793736744305399650068324779832920449571128406381195057599494539495719265448905682934458434094839365843432367426280317832018301235396448313025835566537081578"},
"x":
"48125235751028356251095040896061347545212305980588342275745747906887358070841304927103717361428976664220107282840935647365473727757530480879443309880389481983064766779154481722897268808540768899389735007553163421654258992800910082222407116606570499933273860937258857052095571071067930226982099994440455049317"}
"""))

print tally.discrete_logs

result, proof = tally.decrypt_and_prove(sk)

print result